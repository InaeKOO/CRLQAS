Traceback (most recent call last):
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/main_2q_median.py", line 313, in <module>
    train(agent, environment, conf['general']['episodes'], args.seed,
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/main_2q_median.py", line 214, in train
    one_episode(e, env, agent, episodes)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/main_2q_median.py", line 145, in one_episode
    next_state, reward, done = env.step(agent.translate[action])
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/environment/environment_tc_2q_median.py", line 224, in step
    x0 = self.adam_spsa_v2(angles)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/environment/environment_tc_2q_median.py", line 424, in adam_spsa_v2
    res = vc_h.min_spsa_v2(ener_fn, x0, maxfev = self.maxfev, **self.options)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/environment/VQE_files/VQE_helper.py", line 297, in min_spsa_v2
    a_grad, m, v = adam_grad(epoch, grad, m, v, beta_1t, beta_2, epsilon)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 250, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr = _python_pjit_helper(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 158, in _python_pjit_helper
    args_flat, _, params, in_tree, out_tree, _, jaxpr = infer_params_fn(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/api.py", line 300, in infer_params
    return pjit.common_infer_params(pjit_info_args, *args, **kwargs)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 499, in common_infer_params
    jaxpr, consts, canonicalized_out_shardings_flat = _pjit_jaxpr(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 961, in _pjit_jaxpr
    jaxpr, final_consts, out_type = _create_pjit_jaxpr(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/linear_util.py", line 345, in memoized_fun
    ans = call(fun, *args)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 914, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts = pe.trace_to_jaxpr_dynamic(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/interpreters/partial_eval.py", line 2155, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/interpreters/partial_eval.py", line 2177, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/linear_util.py", line 188, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/environment/VQE_files/VQE_helper.py", line 229, in adam_grad
    m = beta_1 * m + (1 - beta_1) * grad
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/numpy/array_methods.py", line 791, in op
    return getattr(self.aval, f"_{name}")(self, *args)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/numpy/array_methods.py", line 258, in deferring_binary_op
    return binary_op(*args)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 250, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr = _python_pjit_helper(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 158, in _python_pjit_helper
    args_flat, _, params, in_tree, out_tree, _, jaxpr = infer_params_fn(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/api.py", line 300, in infer_params
    return pjit.common_infer_params(pjit_info_args, *args, **kwargs)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 448, in common_infer_params
    explicit_args, in_tree = tree_flatten(dyn_args)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/tree_util.py", line 61, in tree_flatten
    return pytree.flatten(tree, is_leaf)
KeyboardInterrupt
Traceback (most recent call last):
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/main_2q_median.py", line 313, in <module>
    train(agent, environment, conf['general']['episodes'], args.seed,
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/main_2q_median.py", line 214, in train
    one_episode(e, env, agent, episodes)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/main_2q_median.py", line 145, in one_episode
    next_state, reward, done = env.step(agent.translate[action])
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/environment/environment_tc_2q_median.py", line 224, in step
    x0 = self.adam_spsa_v2(angles)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/environment/environment_tc_2q_median.py", line 424, in adam_spsa_v2
    res = vc_h.min_spsa_v2(ener_fn, x0, maxfev = self.maxfev, **self.options)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/environment/VQE_files/VQE_helper.py", line 297, in min_spsa_v2
    a_grad, m, v = adam_grad(epoch, grad, m, v, beta_1t, beta_2, epsilon)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 250, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr = _python_pjit_helper(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 158, in _python_pjit_helper
    args_flat, _, params, in_tree, out_tree, _, jaxpr = infer_params_fn(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/api.py", line 300, in infer_params
    return pjit.common_infer_params(pjit_info_args, *args, **kwargs)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 499, in common_infer_params
    jaxpr, consts, canonicalized_out_shardings_flat = _pjit_jaxpr(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 961, in _pjit_jaxpr
    jaxpr, final_consts, out_type = _create_pjit_jaxpr(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/linear_util.py", line 345, in memoized_fun
    ans = call(fun, *args)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 914, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts = pe.trace_to_jaxpr_dynamic(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/interpreters/partial_eval.py", line 2155, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/interpreters/partial_eval.py", line 2177, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/linear_util.py", line 188, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/environment/VQE_files/VQE_helper.py", line 229, in adam_grad
    m = beta_1 * m + (1 - beta_1) * grad
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/numpy/array_methods.py", line 791, in op
    return getattr(self.aval, f"_{name}")(self, *args)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/numpy/array_methods.py", line 258, in deferring_binary_op
    return binary_op(*args)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 250, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr = _python_pjit_helper(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 158, in _python_pjit_helper
    args_flat, _, params, in_tree, out_tree, _, jaxpr = infer_params_fn(
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/api.py", line 300, in infer_params
    return pjit.common_infer_params(pjit_info_args, *args, **kwargs)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/pjit.py", line 448, in common_infer_params
    explicit_args, in_tree = tree_flatten(dyn_args)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/tree_util.py", line 61, in tree_flatten
    return pytree.flatten(tree, is_leaf)
KeyboardInterrupt
