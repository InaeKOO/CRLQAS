Last action of the episode now.
Last angle is [ 3.5066557   1.8973695   2.0785928  -1.7477036   2.4547129  -3.1853197
 -1.333968    3.5361032   1.3483764   0.47233889 -5.6293125   1.1488115
  1.4923055  -3.703969   -4.285155   -1.5220062 ]
noiseless error is 0.0001952272999261595
episode: 0/10000, score: 23, e: 1.0, rwd: -0.2178432047367096

Last action of the episode now.
Last angle is [ 0.9178392  -0.20396599 -1.5929629   6.2630167  -0.3526823   1.1967127
  4.4339366   0.77219766 -5.5186367  -2.0018868   2.4957612  -0.20488456
  1.1216037  -5.0340867   4.236931    5.3835278   0.08877188 -0.74160314
 -0.47042772 -2.2760665  -2.7830656   0.06142899  4.362876    2.7235162
  1.1489707  -1.5095508   1.7281929   1.0430954  -0.06746083]
noiseless error is 0.7860800248730158
Episode time is 33.98826494599962 seconds
Last action of the episode now.
Last angle is [-1.07515    -3.7689745   1.6219939   0.29854175 -3.6348684   0.5505831
 -3.2133768  -0.06715811 -0.18718657 -5.4620457  -0.02073198  0.507693
 -1.4967359  -1.6420364  -0.13668673  0.0214406 ]
noiseless error is 0.00939794603466737
Episode time is 10.316911131998495 seconds
Last action of the episode now.
Last angle is [-1.0296981  -1.7281488   1.5080478   0.9822117   4.246428   -1.9482858
 -1.3727754  -2.8210216  -1.1446174   0.01095495 -2.2605567   4.2956295
 -0.57959324  0.69364655 -0.11922696]
noiseless error is 0.0009495836842035033
episode: 2/10000, score: 24, e: 1.0, rwd: -0.17213532328605652

Episode time is 10.326298759000565 seconds
Last action of the episode now.
Last angle is [-2.7222426  -6.7661695  -5.292002    1.0746197  -1.2302307   0.12904915
  2.881755    3.0909684   1.9588891   3.0943801   1.068076   -0.02178276
  3.846667   -2.1735728  -1.2198973   0.04018078 -0.26592916 -1.0273064
  2.2378836 ]
noiseless error is 0.001693092023131726
Episode time is 12.194014548998894 seconds
Last action of the episode now.
Last angle is [ 5.7999387  -2.3680778  11.976347    4.526287   -0.43560654  1.9211136
  3.9670138  -0.25620824  1.7284901   1.7662742   2.8434114   0.5875678
 -1.6243976   0.66835564 -0.7457786 ]
noiseless error is 5.551401257264388e-05
episode: 4/10000, score: 20, e: 1.0, rwd: -0.0024382176343351603

Episode time is 8.945122529999935 seconds
Last action of the episode now.
Last angle is [-2.056269   -6.5204706   0.90715146 -7.745276    1.0518627  -4.1477065
 -3.1107402  -1.7405795   1.7824963   0.51705456 -7.0625033  -0.91431475
 -0.55756694  0.44607466  0.38292527  1.0890335  -2.5235524   3.3696475
 -2.4686685   0.9793108   0.02631534]
noiseless error is 0.00016995493054139388
Episode time is 11.911386638001204 seconds
Last action of the episode now.
Last angle is [-7.761033   -0.3545101   2.6463358   0.8553319   5.953915    1.7858615
  1.0862304  -0.66275185  1.8875816  -1.07966    -1.1683842   0.01556206
  0.24544995 -1.1296992 ]
noiseless error is 0.00044604364514100325
episode: 6/10000, score: 22, e: 1.0, rwd: -0.07282247394323349

Episode time is 9.499264435000441 seconds
Last action of the episode now.
Last angle is [-11.372833     2.2792964   -4.2315955    6.6226816    3.307225
   3.318822     0.9115567    4.072308    -3.6437356    3.0278583
   3.3756495   -2.400182    -1.0069362   -3.6416638   -2.8960602
   1.3824556    3.2602973   -0.64244515  -1.9182216    0.4664821
  -0.16419294  -0.6418248 ]
noiseless error is 0.0026082617390130736
Episode time is 12.190547289999813 seconds
Last action of the episode now.
Last angle is [ 2.6298559   4.185424    1.5338848  -2.1443305  -0.8278005   3.1314447
  4.8694935  -0.7282239  -3.141599    3.7989023   0.9218929   1.7450383
  2.041896    0.8229692  -0.78427273]
noiseless error is 8.245531201112044e-05
episode: 8/10000, score: 22, e: 1.0, rwd: 0.026546107605099678

Episode time is 9.047316181999122 seconds
Last action of the episode now.
Last angle is [ 2.6445796   2.6078885   3.637214    0.42815027  0.09989855  2.3598018
  1.0349106  -2.435216   -1.173834   -0.45552865  0.26596725  0.040873  ]
noiseless error is 0.0006007773029779173
Episode time is 7.77505396000015 seconds
Last action of the episode now.
Last angle is [ 0.9511178   1.1501805  -1.1773535   4.723823   -0.89840376 -0.84226155
  6.799798    1.9711945  -1.353056    2.492699    1.9367491   0.9645516
  1.2195904   1.5035453  -0.48365343]
noiseless error is 4.311624645936263e-05
episode: 10/10000, score: 21, e: 1.0, rwd: -0.06447003036737442

Episode time is 8.70324729099957 seconds
Last action of the episode now.
Last angle is [ 4.2787642  -3.3433585  -5.890985   -2.5233047  -3.483222    5.545515
 -5.420374    1.8725563  11.40229    -1.2853612  -0.6147632  -4.5355873
 -0.21973012 -4.415867   -0.22866365 -4.0792723   1.1328924  -5.550519
  1.2942609   2.8326085  -2.6614368  -2.2959356   4.7304516  -0.36831978]
noiseless error is 7.387224316346419e-05
Episode time is 13.431199089000074 seconds
Last action of the episode now.
Last angle is [ 4.2527924  -3.5833426  -5.2966366   6.563359    3.6034532   7.0318155
  4.5560465  -3.0072494  -2.0879512   4.471613   -1.3127477  -1.8231658
 -0.35521087  0.9203379   1.0896481  -1.133981   -0.9103601 ]
noiseless error is 6.195131420838607e-05
episode: 12/10000, score: 23, e: 1.0, rwd: -0.0711129903793335

Episode time is 9.565120931998536 seconds
Last action of the episode now.
Last angle is [-1.0684347  -1.6766161   3.715261   11.046455    0.17360818 -3.8896275
  0.3106857   2.2081666  -2.2300446  -2.4605463  -1.268465    0.35573626
 -1.6953465   1.1660604  -6.723341    2.5624568   2.8951433   0.83387834
 -1.0541078  -0.70041513  1.8738452  -2.4815462 ]
noiseless error is 4.979196667420638e-05
Episode time is 12.997206718000598 seconds
Last action of the episode now.
Last angle is [ 0.46870396  3.7163427   0.38891938  4.412597   -0.53236216  5.3461213
 -0.6845233   4.094004    3.0706553  -0.12577873  0.0809209  -1.7193624
 -3.5833535   0.040383   -1.6942221   1.4331155   0.30438507 -1.3137045
  2.6219947   1.4733111   0.8346334   1.4270607  -1.5479542 ]
noiseless error is 0.00015362325787293685
episode: 14/10000, score: 26, e: 1.0, rwd: -0.05329808220267296

Episode time is 11.843527950999487 seconds
Traceback (most recent call last):
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/main_2q_median.py", line 313, in <module>
    train(agent, environment, conf['general']['episodes'], args.seed,
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/main_2q_median.py", line 214, in train
    one_episode(e, env, agent, episodes)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/main_2q_median.py", line 145, in one_episode
    next_state, reward, done = env.step(agent.translate[action])
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/environment/environment_tc_2q_median.py", line 224, in step
    x0 = self.adam_spsa_v2(angles)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/environment/environment_tc_2q_median.py", line 424, in adam_spsa_v2
    res = vc_h.min_spsa_v2(ener_fn, x0, maxfev = self.maxfev, **self.options)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/environment/VQE_files/VQE_helper.py", line 288, in min_spsa_v2
    Delta_k = Delta_ks[epoch,:]
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/array.py", line 317, in __getitem__
    return lax_numpy._rewriting_take(self, idx)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/numpy/lax_numpy.py", line 4128, in _rewriting_take
    if (result := _attempt_rewriting_take_via_slice(arr, idx, mode)) is not None:
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/numpy/lax_numpy.py", line 4115, in _attempt_rewriting_take_via_slice
    arr = lax.squeeze(arr, tuple(int_indices))
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 1313, in squeeze
    return squeeze_p.bind(array, dimensions=dimensions)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/core.py", line 380, in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/core.py", line 383, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/core.py", line 790, in process_primitive
    return primitive.impl(*tracers, **params)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/dispatch.py", line 144, in apply_primitive
    return compiled_fun(*args)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/dispatch.py", line 227, in <lambda>
    return lambda *args, **kw: compiled(*args, **kw)[0]
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 1342, in __call__
    args = [x for i, x in enumerate(args) if i in self.kept_var_idx]
KeyboardInterrupt
Traceback (most recent call last):
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/main_2q_median.py", line 313, in <module>
    train(agent, environment, conf['general']['episodes'], args.seed,
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/main_2q_median.py", line 214, in train
    one_episode(e, env, agent, episodes)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/main_2q_median.py", line 145, in one_episode
    next_state, reward, done = env.step(agent.translate[action])
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/environment/environment_tc_2q_median.py", line 224, in step
    x0 = self.adam_spsa_v2(angles)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/environment/environment_tc_2q_median.py", line 424, in adam_spsa_v2
    res = vc_h.min_spsa_v2(ener_fn, x0, maxfev = self.maxfev, **self.options)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/jax_noisy/environment/VQE_files/VQE_helper.py", line 288, in min_spsa_v2
    Delta_k = Delta_ks[epoch,:]
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/array.py", line 317, in __getitem__
    return lax_numpy._rewriting_take(self, idx)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/numpy/lax_numpy.py", line 4128, in _rewriting_take
    if (result := _attempt_rewriting_take_via_slice(arr, idx, mode)) is not None:
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/numpy/lax_numpy.py", line 4115, in _attempt_rewriting_take_via_slice
    arr = lax.squeeze(arr, tuple(int_indices))
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 1313, in squeeze
    return squeeze_p.bind(array, dimensions=dimensions)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/core.py", line 380, in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/core.py", line 383, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/core.py", line 790, in process_primitive
    return primitive.impl(*tracers, **params)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/dispatch.py", line 144, in apply_primitive
    return compiled_fun(*args)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/dispatch.py", line 227, in <lambda>
    return lambda *args, **kw: compiled(*args, **kw)[0]
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/home/inae/miniconda3/envs/CRLQAS/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 1342, in __call__
    args = [x for i, x in enumerate(args) if i in self.kept_var_idx]
KeyboardInterrupt
