num qubits is 4
Unitary Matrix is: [[-3.09023366e-01+0.62791518j -2.53351974e-01+0.38978874j
   1.01340362e-01+0.53268409j -5.55660825e-04-0.00905963j]
 [-1.64697824e-01+0.20989102j  5.63581205e-01+0.40850531j
  -5.83826016e-01-0.26567848j  4.97181767e-02-0.17438535j]
 [ 3.60347141e-01-0.35691553j -6.69926280e-02+0.31317269j
  -2.28040657e-01+0.41387536j  6.42566966e-01+0.06331217j]
 [ 4.24522154e-01-0.03987038j -4.07696475e-01+0.17491594j
  -2.66673840e-01+0.0113853j  -4.30427699e-01-0.60404199j]]
H2
Traceback (most recent call last):
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/clus/main_clus.py", line 312, in <module>
    train(agent, environment, conf['general']['episodes'], args.seed,
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/clus/main_clus.py", line 214, in train
    one_episode(e, env, agent, episodes)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/clus/main_clus.py", line 145, in one_episode
    next_state, reward, done = env.step(agent.translate[action])
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/clus/environment/environment_tc_qas.py", line 242, in step
    x0 = self.cobyla_min(angles)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/clus/environment/environment_tc_qas.py", line 451, in cobyla_min
    result_cobyla = minimize(fun=ener_fn, x0=x0, method='COBYLA', options={'maxiter': self.global_iters})
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/scipy/optimize/_minimize.py", line 702, in minimize
    res = _minimize_cobyla(fun, x0, args, constraints, callback=callback,
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/scipy/optimize/_cobyla_py.py", line 34, in wrapper
    return func(*args, **kwargs)
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/scipy/optimize/_cobyla_py.py", line 270, in _minimize_cobyla
    xopt, info = cobyla.minimize(calcfc, m=m, x=np.copy(x0), rhobeg=rhobeg,
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/scipy/optimize/_cobyla_py.py", line 258, in calcfc
    f = fun(np.copy(x), *args)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/clus/environment/VQE_files/VQE_tc_qas.py", line 134, in get_exp_val
    return get_exp_val_4q(angles, param_circ, sigma)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/clus/environment/VQE_files/VQE_main_4q_qas.py", line 100, in get_exp_val_4q
    exp_val += get_noisy_exp_val_4q(angles, param_circ)
  File "/mnt/c/Users/ihkoo/programming/CRLQAS/clus/environment/VQE_files/VQE_main_4q_qas.py", line 807, in get_noisy_exp_val_4q
    exp_val = get_noisy_energy_3g_4q(rho_ptm, circ_instrs_jnp, Hamil_ptm, energy_shift)
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/pjit.py", line 250, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr = _python_pjit_helper(
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/pjit.py", line 163, in _python_pjit_helper
    out_flat = pjit_p.bind(*args_flat, **params)
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/core.py", line 2652, in bind
    return self.bind_with_trace(top_trace, args, params)
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/core.py", line 383, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/core.py", line 790, in process_primitive
    return primitive.impl(*tracers, **params)
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/pjit.py", line 1193, in _pjit_call_impl
    return xc._xla.pjit(name, f, call_impl_cache_miss, [], [], donated_argnums,
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/pjit.py", line 1177, in call_impl_cache_miss
    out_flat, compiled = _pjit_call_impl_python(
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/pjit.py", line 1113, in _pjit_call_impl_python
    always_lower=False, lowering_platform=None).compile()
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 2329, in compile
    executable = UnloadedMeshExecutable.from_hlo(
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 2651, in from_hlo
    xla_executable, compile_options = _cached_compilation(
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 2561, in _cached_compilation
    xla_executable = dispatch.compile_or_get_cached(
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/dispatch.py", line 497, in compile_or_get_cached
    return backend_compile(backend, computation, compile_options,
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/home/inae/miniconda3/envs/CRL/lib/python3.10/site-packages/jax/_src/dispatch.py", line 465, in backend_compile
    return backend.compile(built_c, compile_options=options)
KeyboardInterrupt
